combine topological sort with building async task
